inString='subBlock01.mat';
load(inString,'subBlock')
fs=subBlock.fs;
doorsPost=4*fs;
vftPost=30*fs;
flPost=80*fs;
subRotation={'subBlock01.mat','subBlock02.mat','subBlock03.mat','subBlock04.mat','subBlock05.mat','subBlock06.mat','subBlock07.mat','subBlock08.mat','subBlock09.mat','subBlock10.mat'};
subRotationDeox={'subBlockDeox01.mat','subBlockDeox02.mat','subBlockDeox03.mat','subBlockDeox04.mat','subBlockDeox05.mat','subBlockDeox06.mat','subBlockDeox07.mat','subBlockDeox08.mat','subBlockDeox09.mat','subBlockDeox10.mat'};


% dimensions: DoorsWin,DoorsLos,VFT1,VFT2,VFT3,FlankCon,FlankInc


sub1=[-0.203874174	-0.203861774	-0.203798314	-0.203583467	-0.203028883	-0.201840696	-0.199608099	-0.195793668	-0.189725842	-0.180595426	-0.167458513	-0.149248573	-0.124797112	-0.092859103	-0.052140678	-0.00132689	0.060896195	0.135830048	0.224761462	0.328963998	0.449699647	0.588222669	0.745788492
-0.206783171	-0.206772831	-0.206717703	-0.206525495	-0.206018932	-0.204917565	-0.202825722	-0.199222167	-0.193452239	-0.184724423	-0.172113516	-0.154573023	-0.130956344	-0.100043031	-0.060567722	-0.011249274	0.049186342	0.12199478	0.20841175	0.309654972	0.426926193	0.561415684	0.7143125
-0.167062104	-0.167050668	-0.16699138	-0.16678863	-0.166261046	-0.165123154	-0.162972792	-0.159280354	-0.153380416	-0.144467589	-0.13159896	-0.113705893	-0.089614575	-0.058071461	-0.0177712	0.032615075	0.094416767	0.168951188	0.257520069	0.361409848	0.481892183	0.620226635	0.777668588
-0.167061967	-0.167048771	-0.166979391	-0.166740647	-0.166119933	-0.164789574	-0.162299953	-0.158074295	-0.151405039	-0.141453502	-0.127254165	-0.107725985	-0.081691515	-0.047901481	-0.005062803	0.048132347	0.112982847	0.190765772	0.282732868	0.390110655	0.514101401	0.655888735	0.816652042
-0.1670624	-0.167054065	-0.167010373	-0.166858862	-0.166457719	-0.165574859	-0.163869192	-0.16087296	-0.155977289	-0.148423916	-0.137307147	-0.121589363	-0.100127268	-0.071702513	-0.035053122	0.011096731	0.06801413	0.136946354	0.219119107	0.315738131	0.427990996	0.557050231	0.704079391
-0.183671021	-0.183659538	-0.18360076	-0.183401541	-0.182885956	-0.181776896	-0.179682742	-0.176086094	-0.170335176	-0.161639441	-0.14907197	-0.131581565	-0.108013718	-0.07713637	-0.037667896	0.011694909	0.07225428	0.145299222	0.232102369	0.333920769	0.451996872	0.587561171	0.741839508
-0.183671129	-0.183660509	-0.183605101	-0.183414713	-0.182917388	-0.181841158	-0.179801241	-0.176289165	-0.170664237	-0.162148887	-0.149830465	-0.132672547	-0.109535159	-0.079200003	-0.040398086	0.008162356	0.067772895	0.13971166	0.225238876	0.325596262	0.442006602	0.575675375	0.727798403];

sub2=[-0.004765746	-0.00476304	-0.004748608	-0.004697837	-0.004562235	-0.004263455	-0.003689875	-0.002693869	-0.001088174	0.001358767	0.004927043	0.009947076	0.016798348	0.02590614	0.037737526	0.05279713	0.071622775	0.094780646	0.122858893	0.156458902	0.196184595	0.24263082	0.296372879
-0.00474689	-0.004744561	-0.00473215	-0.004688496	-0.004571878	-0.004314801	-0.00382098	-0.002962888	-0.00157849	0.000532939	0.003614611	0.007953854	0.013880947	0.021766185	0.032016339	0.045071024	0.061399062	0.081494483	0.105871079	0.135054788	0.169574283	0.209950793	0.256688897
-0.005076887	-0.00507673	-0.00507596	-0.005073415	-0.005066884	-0.005052798	-0.005025931	-0.004979021	-0.004901988	-0.004780388	-0.004593325	-0.004311659	-0.003897176	-0.003302582	-0.00247154	-0.001338076	0.000174574	0.002155043	0.004704276	0.00793532	0.011972873	0.016952364	0.023018009
-0.005076566	-0.005072981	-0.005054448	-0.004990945	-0.004825222	-0.004467498	-0.003793183	-0.002641266	-0.000811498	0.001939876	0.0059044	0.011423513	0.018887375	0.028731209	0.041430572	0.057496251	0.077469257	0.101915765	0.131420808	0.166579738	0.207987658	0.256227698	0.311860048
-0.005076636	-0.005073658	-0.005057713	-0.005001637	-0.004852191	-0.004523789	-0.003894931	-0.00280525	-0.001051346	0.001618588	0.005509454	0.010980847	0.018444973	0.028362444	0.041237557	0.057613512	0.078067573	0.10320576	0.133655952	0.17005859	0.213055397	0.263277198	0.321333054
-0.004889021	-0.004886876	-0.004875367	-0.004834782	-0.00472629	-0.004487165	-0.00402795	-0.003230069	-0.001942547	2.22E-05	0.002891862	0.006936054	0.012464611	0.019824827	0.029397994	0.041595893	0.056857284	0.075644083	0.098436324	0.125725287	0.158005026	0.195763079	0.239472009
-0.004888995	-0.00488658	-0.00487364	-0.00482787	-0.004704979	-0.004432911	-0.003908458	-0.002994568	-0.001516903	0.000740484	0.004039075	0.008687647	0.015041255	0.023498378	0.034497354	0.048512592	0.066050689	0.087646047	0.113854877	0.14524685	0.182394799	0.225863636	0.27620046];

sub3=[0.003515223	0.003518624	0.003536718	0.003600406	0.003771607	0.00415388	0.004901809	0.006229682	0.008420076	0.011830861	0.016894468	0.024105977	0.034006094	0.047166814	0.064182476	0.085664328	0.112234593	0.144517927	0.183129972	0.228663335	0.281672616	0.342659379	0.412059066
0.003583837	0.003587404	0.003606026	0.003670668	0.003842625	0.004223645	0.004965087	0.006276706	0.008435424	0.011792329	0.016772012	0.023860947	0.033590114	0.046519394	0.063227553	0.084306843	0.110357926	0.141982516	0.179773237	0.224300865	0.276100382	0.3356567	0.403392074
0.004079414	0.004080962	0.004088586	0.00411381	0.004178318	0.004316812	0.00458	0.005038123	0.005784685	0.006938674	0.008641987	0.011050113	0.014317999	0.018586129	0.023973388	0.0305787	0.038486447	0.047771167	0.058500248	0.070734135	0.084524429	0.099910299	0.116914295
0.004079628	0.004083664	0.004104998	0.004179633	0.004378883	0.004820608	0.005679362	0.007196601	0.00969115	0.013567714	0.019317261	0.027506556	0.038763094	0.053762396	0.073219381	0.097881554	0.128520413	0.165919893	0.210861831	0.264108566	0.326384374	0.398356861	0.480620567
0.004079599	0.004083349	0.004103266	0.004173351	0.004361921	0.004783774	0.005611187	0.007084115	0.009519855	0.013320362	0.018970996	0.027027538	0.038097984	0.05282693	0.071884909	0.095960857	0.125754169	0.161964549	0.205279203	0.256357523	0.315814952	0.384206939	0.462015109
0.003274946	0.003277419	0.003290508	0.00333642	0.003459586	0.003734342	0.004271798	0.005226173	0.006801008	0.009253962	0.012895283	0.018077102	0.025178235	0.034591172	0.046714757	0.061951682	0.080706684	0.103382848	0.130375565	0.162064228	0.198802657	0.240908991	0.288656681
0.003275089	0.003279097	0.003300218	0.003374022	0.003571294	0.004009844	0.004865079	0.006380059	0.008875583	0.012758518	0.018521704	0.026731805	0.038011373	0.053023218	0.072460037	0.09703739	0.127485902	0.164540599	0.208927105	0.261345103	0.32245091	0.392840095	0.473032311];

sub4=[0.003458496	0.003458461	0.003459401	0.003464791	0.003480925	0.003514829	0.003571437	0.003651861	0.003752052	0.003860334	0.003953648	0.00399336	0.003921496	0.003657998	0.003098601	0.002113467	0.000548765	-0.001768594	-0.005027686	-0.009435169	-0.015219487	-0.022632644	-0.031944857
0.003449562	0.003449519	0.003450509	0.003456251	0.003473476	0.003509666	0.003569971	0.003655264	0.003760696	0.003873159	0.003967464	0.004001986	0.003914707	0.003620298	0.003007933	0.00193997	0.000253927	-0.002232069	-0.005715566	-0.0104116	-0.016557541	-0.024415361	-0.034265983
0.004841499	0.004841518	0.004842847	0.004849758	0.004869951	0.004912189	0.004982974	0.005084359	0.005212395	0.005354655	0.005486485	0.00556669	0.005533437	0.005301101	0.004757861	0.003764399	0.002156182	-0.000250509	-0.003654278	-0.00827012	-0.014334338	-0.022107095	-0.031866744
0.004841501	0.004841543	0.004842988	0.004850292	0.004871499	0.004915896	0.004990727	0.005099083	0.005238416	0.005398055	0.005555407	0.005671548	0.005687008	0.005518459	0.005056178	0.004162665	0.002674852	0.000410042	-0.002829863	-0.007259874	-0.013116799	-0.020661728	-0.030174342
0.004841504	0.004841578	0.004843172	0.004850955	0.004873338	0.004920127	0.00499923	0.005114565	0.005264589	0.005439812	0.005618998	0.005764759	0.005819319	0.005701136	0.005302321	0.004487218	0.003094578	0.000943398	-0.002162922	-0.006438118	-0.012117917	-0.01946249	-0.028750739
0.004704448	0.004704367	0.004705082	0.004709744	0.004724094	0.004754366	0.004804417	0.004873868	0.004956664	0.005038566	0.005093446	0.005079179	0.004934019	0.004574021	0.003890976	0.002750914	0.000995432	-0.001553836	-0.005092291	-0.009834432	-0.016018494	-0.023908399	-0.03378819
0.004704455	0.004704477	0.004705807	0.004712701	0.004732826	0.004774949	0.004845832	0.004948388	0.005080357	0.005231855	0.005381545	0.005492227	0.005506714	0.005344677	0.004900266	0.004040752	0.002608536	0.000426671	-0.002697336	-0.006973205	-0.012632653	-0.019931758	-0.029145655];

sub4=sub4.*-1;

sub5=[-0.013446862	-0.013445548	-0.013437491	-0.013407037	-0.013323361	-0.013139225	-0.012793503	-0.012215383	-0.01132821	-0.010051794	-0.008302346	-0.005990001	-0.003016776	0.00072019	0.005319441	0.010866663	0.017431939	0.025067322	0.033798018	0.043613644	0.054469799	0.066299298	0.079027151
-0.011702891	-0.011701419	-0.011692513	-0.011659113	-0.011567831	-0.011367761	-0.010993268	-0.010368499	-0.009411479	-0.008036598	-0.006154675	-0.003670622	-0.000481555	0.003519804	0.008435877	0.014355966	0.021354297	0.029488795	0.038793379	0.0492697	0.060888473	0.073599946	0.087347813
0.00112687	0.001127732	0.00113299	0.001152764	0.001206723	0.001324373	0.001542701	0.001902752	0.002446687	0.003216223	0.004252918	0.005600218	0.007304996	0.009414717	0.011970618	0.015003093	0.018531872	0.022564337	0.027086791	0.032055764	0.037398762	0.043023702	0.04883201
0.001126908	0.00112848	0.001138554	0.001177543	0.001286389	0.001529325	0.00199249	0.002780918	0.004015546	0.005830637	0.008372079	0.011796913	0.016272114	0.021968541	0.029049724	0.037662608	0.047935597	0.059976909	0.073865089	0.089639127	0.107299682	0.126820201	0.148161158
0.001126966	0.001129097	0.001141849	0.001189287	0.001318113	0.001599186	0.002123939	0.002998847	0.004340375	0.006271661	0.008922023	0.012429552	0.016943702	0.022622412	0.029622312	0.038089021	0.048154697	0.059937535	0.073534195	0.089010909	0.106404819	0.125735697	0.147022324
-0.031328602	-0.031327527	-0.031320961	-0.031296179	-0.031228091	-0.031077954	-0.030794852	-0.030318372	-0.029581231	-0.028511248	-0.027032188	-0.025063366	-0.022519885	-0.019317003	-0.015378297	-0.010641518	-0.005059322	0.001398426	0.008735293	0.016919354	0.025884435	0.035540158	0.045784854
-0.031328588	-0.031327298	-0.031319358	-0.031289307	-0.031206874	-0.031026193	-0.030688943	-0.030129107	-0.029277085	-0.028061886	-0.026410465	-0.024244263	-0.021476098	-0.018012691	-0.01376371	-0.00865063	-0.002609618	0.004406583	0.012420728	0.021422864	0.031371926	0.042206732	0.053860561];

sub6=[4.48E-05	5.14E-05	8.27E-05	0.000184393	0.000441809	0.000991321	0.002028909	0.003814558	0.006672118	0.010986502	0.017199376	0.025802112	0.03732571	0.052329763	0.071392568	0.095103178	0.124055482	0.158843707	0.200058185	0.248280618	0.304079043	0.368003851	0.440585713
4.73E-05	5.41E-05	8.67E-05	0.000193369	0.000464796	0.001047234	0.002152093	0.004061159	0.007126883	0.011769874	0.01847466	0.027782124	0.040278277	0.056581885	0.077333391	0.103185946	0.134798646	0.172831297	0.217939493	0.270769181	0.331950975	0.40209571	0.481792157
4.34E-05	4.38E-05	4.61E-05	5.34E-05	7.15E-05	0.000109505	0.000179683	0.000298047	0.000484212	0.000761425	0.001156459	0.001699321	0.002422808	0.00336203	0.004553969	0.006037075	0.007850865	0.010035507	0.012631405	0.015678806	0.019217443	0.023286251	0.027923203
4.38E-05	4.80E-05	6.82E-05	0.000133952	0.000301005	0.000659187	0.001338607	0.00251288	0.004399214	0.007256589	0.011382653	0.017108687	0.024792721	0.034812282	0.047557996	0.063428456	0.082826326	0.106155297	0.133817116	0.16620826	0.203716357	0.246717298	0.295573625
4.43E-05	5.42E-05	0.000101813	0.000257805	0.000655523	0.001509174	0.003127338	0.005919682	0.010396486	0.017164017	0.026917699	0.040431294	0.058541463	0.082130844	0.112112842	0.149419217	0.194990503	0.249768322	0.314688079	0.390671021	0.478616016	0.579393253	0.693841453
5.65E-05	6.02E-05	7.85E-05	0.000138232	0.00029043	0.000617091	0.001236508	0.002305954	0.004021623	0.006616944	0.010359957	0.015549066	0.022507036	0.031574495	0.043104129	0.057455949	0.074993649	0.096081676	0.121082438	0.150353241	0.184243092	0.223090201	0.267220768
5.69E-05	6.44E-05	0.000100856	0.000219544	0.00052076	0.001164902	0.002382557	0.004479558	0.007836665	0.012906152	0.020206771	0.030315634	0.043856413	0.061486283	0.083884178	0.111741333	0.145754295	0.186619652	0.235029127	0.291664085	0.357189696	0.432250403	0.517467651];

sub7=[-0.034277406	-0.034275245	-0.034263631	-0.03422287	-0.034115493	-0.033884372	-0.033453692	-0.032730683	-0.031607649	-0.029964514	-0.027671416	-0.024590875	-0.02057961	-0.015490402	-0.009174796	-0.001486701	0.007714779	0.018564727	0.031193041	0.045724649	0.06227886	0.080969379	0.101908195
-0.03130054	-0.031298445	-0.031286922	-0.031245834	-0.031136392	-0.030898976	-0.030454102	-0.029704423	-0.028537095	-0.026826542	-0.02443712	-0.021225303	-0.017041474	-0.011731781	-0.005140874	0.002884372	0.01249187	0.023823518	0.037015675	0.052199236	0.069498854	0.089032782	0.110916487
-0.001604147	-0.00160372	-0.001601396	-0.001593157	-0.001571242	-0.001523598	-0.001433868	-0.001281596	-0.001042547	-0.000689208	-0.000191312	0.000483706	0.001370343	0.002504628	0.003923586	0.005664552	0.007764715	0.010261111	0.013190845	0.016591171	0.020499358	0.024952625	0.029988763
-0.001604022	-0.001602104	-0.001591448	-0.001553175	-0.001450654	-0.001227129	-0.000806322	-9.41E-05	0.001019309	0.00265669	0.004951112	0.00804374	0.012081994	0.017217625	0.023603987	0.031392456	0.04072971	0.051757145	0.064611382	0.079424154	0.096321267	0.115422231	0.136843607
-0.001604004	-0.001601877	-0.001590076	-0.001547736	-0.001434417	-0.001187585	-0.000723393	6.13E-05	0.001286479	0.003085748	0.005603542	0.00899266	0.013412333	0.019026203	0.025999397	0.034494686	0.044669645	0.056676238	0.070661552	0.086767743	0.105130896	0.12588059	0.149143661
-0.001593607	-0.001593415	-0.00159239	-0.00158878	-0.001579182	-0.001558211	-0.001518385	-0.001450088	-0.001341632	-0.001179414	-0.000948126	-0.000630964	-0.00020981	0.000334575	0.001022315	0.001874155	0.002911269	0.004155263	0.005628287	0.007353139	0.009353284	0.01165286	0.014276891
-0.001593486	-0.001591865	-0.001582875	-0.001550627	-0.001464331	-0.001276365	-0.000922833	-0.000325023	0.000608728	0.001980761	0.003901869	0.006489476	0.009866129	0.014157939	0.019492316	0.025995005	0.033787864	0.042988466	0.053710587	0.06606413	0.08015425	0.096081011	0.113942113];

sub8=[-0.067618935	-0.067612448	-0.067578688	-0.067462788	-0.067160656	-0.066510083	-0.065287231	-0.06320513	-0.05991229	-0.054990233	-0.04794956	-0.038224935	-0.025167974	-0.008038217	0.014002198	0.041886807	0.076640693	0.119378034	0.171299754	0.233688381	0.307900162	0.395357867	0.497547338
-0.060264672	-0.060257334	-0.060219415	-0.060089866	-0.059753224	-0.059029696	-0.057670967	-0.055358108	-0.051699577	-0.046228071	-0.038395681	-0.027567665	-0.013013391	0.006105335	0.030741642	0.06196209	0.100940913	0.148954662	0.207376788	0.277670472	0.361379685	0.46012122	0.575580698
-0.126822695	-0.126815263	-0.12677692	-0.126646011	-0.126305821	-0.12557427	-0.124199346	-0.12185661	-0.118146758	-0.112591936	-0.104630409	-0.093610019	-0.078778763	-0.059272561	-0.034107616	-0.002182115	0.037718148	0.086915328	0.146834995	0.218998941	0.305015439	0.406570247	0.525421437
-0.126822708	-0.126815401	-0.126777681	-0.126648858	-0.126314032	-0.12559395	-0.124240478	-0.121934037	-0.11828099	-0.112809685	-0.104964952	-0.094101565	-0.079474929	-0.060228898	-0.035388167	-0.003859998	0.035560409	0.084186096	0.143434465	0.214820426	0.299946816	0.400495461	0.518221809
-0.12682271	-0.126815457	-0.126778095	-0.126650613	-0.126319264	-0.125606198	-0.124264575	-0.121975706	-0.118346203	-0.112903977	-0.105093123	-0.09426847	-0.07968807	-0.060503143	-0.035752061	-0.00436257	0.034843048	0.083144521	0.141920134	0.212640294	0.296858144	0.396200473	0.512362034
-0.12556556	-0.125559029	-0.1255251	-0.125408605	-0.125104524	-0.124448427	-0.123212385	-0.12110318	-0.117760778	-0.112755676	-0.105584702	-0.095665797	-0.082330683	-0.064815553	-0.042255686	-0.013687695	0.02194525	0.065789475	0.119076762	0.183117675	0.259292476	0.34904309	0.453869439
-0.125565491	-0.125558292	-0.125521203	-0.125394768	-0.125066681	-0.124362116	-0.123039484	-0.120788082	-0.117225697	-0.111895085	-0.104259163	-0.093695356	-0.079487277	-0.060813522	-0.036740543	-0.006224056	0.031886243	0.078843574	0.136001235	0.204807065	0.286794956	0.383576276	0.496833973];

sub9=[-0.147437524	-0.147426331	-0.147367478	-0.147160231	-0.146600278	-0.14534792	-0.142916387	-0.138679124	-0.131881742	-0.121647945	-0.106982335	-0.086776202	-0.059816466	-0.024795665	0.019677707	0.075067508	0.142893847	0.224709497	0.322069279	0.436495783	0.5694454	0.7222796	0.896246775
-0.139450038	-0.139439545	-0.139383654	-0.13918459	-0.138641575	-0.13741786	-0.135028387	-0.130847021	-0.124118323	-0.113962987	-0.099380865	-0.079258404	-0.052379874	-0.017439205	0.026948646	0.082235845	0.149926038	0.231551611	0.32864412	0.442701065	0.575152859	0.727334974	0.900470751
-0.196055015	-0.196045352	-0.19599303	-0.195804375	-0.195284921	-0.194105844	-0.191790738	-0.187722199	-0.181153393	-0.171213526	-0.156910839	-0.137139763	-0.110691706	-0.076266589	-0.032484203	0.022103703	0.088997272	0.169725064	0.265813939	0.378755839	0.509975203	0.660801513	0.832452154
-0.196055057	-0.196045805	-0.195995392	-0.195812461	-0.195305544	-0.194148155	-0.191864302	-0.187834587	-0.181307783	-0.17140635	-0.157129702	-0.137362152	-0.110884769	-0.076387985	-0.032483892	0.022280927	0.089408935	0.170428343	0.26686346	0.38020197	0.51186277	0.663168952	0.835331253
-0.196054819	-0.196043306	-0.195982372	-0.19576682	-0.195182482	-0.193872233	-0.191323256	-0.186874745	-0.179730935	-0.168967948	-0.153537944	-0.132277245	-0.103918042	-0.067100847	-0.020386717	0.037729886	0.108804202	0.194416855	0.296142853	0.415517636	0.554003966	0.712964196	0.893643135
-0.191143214	-0.191133509	-0.191081066	-0.190892356	-0.190373504	-0.189196727	-0.186886918	-0.182828208	-0.176275586	-0.166360219	-0.15209211	-0.132366898	-0.105976407	-0.071619959	-0.027915365	0.026589414	0.09340049	0.174054667	0.270089024	0.383007094	0.514245559	0.665146141	0.836937801
-0.191143136	-0.191132835	-0.191078104	-0.190883387	-0.190352122	-0.189153645	-0.186810169	-0.182703238	-0.176084797	-0.166081925	-0.151699326	-0.131826499	-0.105248915	-0.070659971	-0.026672661	0.028168107	0.095369322	0.176466586	0.272994172	0.386451709	0.518271234	0.66978938	0.842230005];

sub10=[-0.273394885	-0.273372849	-0.273266385	-0.272917834	-0.272032136	-0.2701469	-0.26662205	-0.260645342	-0.251245375	-0.23730774	-0.217597824	-0.190793557	-0.15552187	-0.110390668	-0.054016661	0.014947647	0.097787492	0.195698798	0.30975621	0.440877562	0.589797803	0.757062068	0.943035682
-0.272683081	-0.27266178	-0.272559376	-0.272225071	-0.271375967	-0.269566054	-0.26617396	-0.26040718	-0.251313837	-0.237796935	-0.21863565	-0.192518056	-0.158078582	-0.113930975	-0.058696457	0.008969851	0.090353867	0.186657275	0.298966757	0.428218333	0.575169947	0.740392386	0.924276861
-0.264748519	-0.264726377	-0.264619453	-0.264269547	-0.263380528	-0.261487862	-0.257947958	-0.251944063	-0.242499612	-0.228493953	-0.208684453	-0.181739123	-0.146273602	-0.100883807	-0.044173755	0.025218627	0.10859757	0.207185623	0.322093729	0.454285792	0.604553113	0.773510426	0.961609511
-0.264748495	-0.264726193	-0.264618844	-0.264268344	-0.263378878	-0.261485896	-0.257945098	-0.25193862	-0.242488551	-0.228472025	-0.208642501	-0.181662134	-0.146139082	-0.100660766	-0.043822412	0.025746498	0.109357809	0.208240653	0.323511688	0.456140102	0.606922313	0.776477624	0.965261066
-0.264748412	-0.264725074	-0.26461196	-0.26424158	-0.263302325	-0.261309098	-0.257593932	-0.251312383	-0.241457232	-0.226874951	-0.206288628	-0.178331113	-0.141582536	-0.094603898	-0.035966335	0.03572155	0.121789004	0.223479679	0.341922361	0.478095612	0.632802256	0.8066666	1.000150156
-0.318283778	-0.318261253	-0.318152789	-0.317798697	-0.316900667	-0.31499128	-0.311423652	-0.305378175	-0.295876679	-0.281798492	-0.261902927	-0.234862655	-0.199301246	-0.153825876	-0.097055181	-0.027645559	0.055684023	0.15412742	0.26876146	0.400511242	0.550123992	0.718161686	0.905010096
-0.318283588	-0.31825952	-0.318145064	-0.317775686	-0.316847685	-0.314888102	-0.311243254	-0.305083632	-0.295416295	-0.281099616	-0.260865015	-0.233350243	-0.197137611	-0.150788062	-0.092870809	-0.021991386	0.063182153	0.163893709	0.281268498	0.416277673	0.569712284	0.742176897	0.934099253];

%% divide data
chanSel=1;
doorsWin=[sub1(chanSel,:); sub2(chanSel,:); sub3(chanSel,:); sub4(chanSel,:); sub5(chanSel,:); sub6(chanSel,:); sub7(chanSel,:); sub8(chanSel,:); sub9(chanSel,:); sub10(chanSel,:)];

chanSel=2;
doorsLos=[sub1(chanSel,:); sub2(chanSel,:); sub3(chanSel,:); sub4(chanSel,:); sub5(chanSel,:); sub6(chanSel,:); sub7(chanSel,:); sub8(chanSel,:); sub9(chanSel,:); sub10(chanSel,:)];

chanSel=3;
vft1=[sub1(chanSel,:); sub2(chanSel,:); sub3(chanSel,:); sub4(chanSel,:); sub5(chanSel,:); sub6(chanSel,:); sub7(chanSel,:); sub8(chanSel,:); sub9(chanSel,:); sub10(chanSel,:)];

chanSel=4;
vft2=[sub1(chanSel,:); sub2(chanSel,:); sub3(chanSel,:); sub4(chanSel,:); sub5(chanSel,:); sub6(chanSel,:); sub7(chanSel,:); sub8(chanSel,:); sub9(chanSel,:); sub10(chanSel,:)];

chanSel=5;
vft3=[sub1(chanSel,:); sub2(chanSel,:); sub3(chanSel,:); sub4(chanSel,:); sub5(chanSel,:); sub6(chanSel,:); sub7(chanSel,:); sub8(chanSel,:); sub9(chanSel,:); sub10(chanSel,:)];

chanSel=6;
flankCon=[sub1(chanSel,:); sub2(chanSel,:); sub3(chanSel,:); sub4(chanSel,:); sub5(chanSel,:); sub6(chanSel,:); sub7(chanSel,:); sub8(chanSel,:); sub9(chanSel,:); sub10(chanSel,:)];

chanSel=7;
flankInc=[sub1(chanSel,:); sub2(chanSel,:); sub3(chanSel,:); sub4(chanSel,:); sub5(chanSel,:); sub6(chanSel,:); sub7(chanSel,:); sub8(chanSel,:); sub9(chanSel,:); sub10(chanSel,:)];



%% channel breakdown
% doorsLos=nirsChannelCombine(doorsLos);
% doorsWin=nirsChannelCombine(doorsWin);
% vft1=nirsChannelCombine(vft1);
% vft2=nirsChannelCombine(vft2);
% vft3=nirsChannelCombine(vft3);
% flankCon=nirsChannelCombine(flankCon);
% flankInc=nirsChannelCombine(flankInc);
% 
% 
% %% comparison
% 
% chanCom=5;
% [h51,p51]=ttest2(doorsLos(:,chanCom),doorsWin(:,chanCom));
% 
% [h52,p52]=ttest2(vft1(:,chanCom),vft3(:,chanCom));
% 
% [h53,p53]=ttest2(flankCon(:,chanCom),flankInc(:,chanCom));
% 
% chanCom=7;
% [h71,p71]=ttest2(doorsLos(:,chanCom),doorsWin(:,chanCom));
% 
% [h72,p72]=ttest2(vft1(:,chanCom),vft3(:,chanCom));
% 
% [h73,p73]=ttest2(flankCon(:,chanCom),flankInc(:,chanCom));

%% average subjects
doorsLos=mean(doorsLos);
doorsWin=mean(doorsWin);
vft1=mean(vft1);
vft2=mean(vft2);
vft3=mean(vft3);
flankCon=mean(flankCon);
flankInc=mean(flankInc);

%% make picture
chanCom=23;
doorBlock=ones(doorsPost,1);
%vftBlock=ones(vftPost,1)+ rand(vftPost,1);
vftBlock=ones(vftPost,1);
flBlock=ones(flPost,1);

doors=[doorsLos(:,chanCom).*doorBlock; doorsWin(:,chanCom).*doorBlock];
vft=[vft1(:,chanCom).*vftBlock; vft2(:,chanCom).*vftBlock; vft3(:,chanCom).*vftBlock];
flank=[flankInc(:,chanCom).*flBlock; flankCon(:,chanCom).*flBlock];

vft=vft/max(abs(vft));
%patch([0 length(x)],[yn(1) yp(1)],'red')
%area(x,yp,'FaceColor','g')
%area(x,yn,'FaceColor','g')
%x0 = [0 0 length(t) length(t)];
%y0 = [yp(1) yn(1) yn(end) yp(end)];
%% doors plot
x=doors;
%x=x/max(max(abs(x)));
t=linspace(0,length(x),length(x));

scaleFac=max([.5,std(x),10.*std(x)]);
yp = 1.*(x + scaleFac);
yn = 1.*(x - scaleFac);
x0 = [0 0 ceil(length(t)/2) ceil(length(t)/2)];
y0 = [yp(1) yn(1) yn(1) yp(1)];
x1 = [ceil(length(t)/2) ceil(length(t)/2) length(t) length(t)];
y1 = [yp(end) yn(end) yn(end) yp(end)];

figure;

patch(x0,y0,'green')
hold on;
patch(x1,y1,'green')
set(0,'defaultlinelinewidth',1.75)
plot(t,x,'r')
ylabel('HbO (mMol.mm)')
xlabel('Time (Samples at 10 Hz)')
hold off;

%% flanker plot

x=flank;
%x=x/max(abs(x));
t=linspace(0,length(x),length(x));

scaleFac=max([.5,std(x),10.*std(x)]);
yp = 1.*(x + scaleFac);
yn = 1.*(x - scaleFac);
x0 = [0 0 ceil(length(t)/2) ceil(length(t)/2)];
y0 = [yp(1) yn(1) yn(1) yp(1)];
x1 = [ceil(length(t)/2) ceil(length(t)/2) length(t) length(t)];
y1 = [yp(end) yn(end) yn(end) yp(end)];

figure;
patch(x0,y0,'green')
hold on;
patch(x1,y1,'green')
set(0,'defaultlinelinewidth',1.75)
plot(t,x,'r')
ylabel('HbO (mMol.mm)')
xlabel('Time (Samples at 10 Hz)')
hold off;

%% vft plot

x=vft;
%x=x/max(max(abs(x)));
t=linspace(0,length(x),length(x));

scaleFac=max([.5,std(x),10.*std(x)]);
yp = 1.*(x + scaleFac);
yn = 1.*(x - scaleFac);
x0 = [0 0 ceil(length(t)/3) ceil(length(t)/3)];
y0 = [yp(1) yn(1) yn(1) yp(1)];

x1 = [ceil(length(t)/3) ceil(length(t)/3) ceil(2*length(t)/3) ceil(2*length(t)/3)];
y1 = [yp(ceil(length(t)/2)) yn(ceil(length(t)/2)) yn(ceil(length(t)/2)) yp(ceil(length(t)/2))];

x2 = [ceil(2*length(t)/3) ceil(2*length(t)/3) length(t) length(t)];
y2 = [yp(end) yn(end) yn(end) yp(end)];

figure;
patch(x0,y0,'green')
%ylim([0 1])
hold on;
patch(x1,y1,'green')
patch(x2,y2,'green')
set(0,'defaultlinelinewidth',1.75)
plot(t,x,'r')
ylabel('HbO (mMol.mm)')
xlabel('Time (Samples at 10 Hz)')
hold off;

% make bars like excel


%% vft plot

x=vft;
x=x/max(max(abs(x)));

t=linspace(0,(3*vftPost/fs),length(x));
scaleFac=max([.5,std(x),10.*std(x)]);
yp = 1.*(x + scaleFac);
yn = 1.*(x - scaleFac);
x0 = [0 0 ceil(length(t)/3) ceil(length(t)/3)];
y0 = [yp(1) yn(1) yn(1) yp(1)];

x1 = [ceil(length(t)/3) ceil(length(t)/3) ceil(2*length(t)/3) ceil(2*length(t)/3)];
y1 = [yp(ceil(length(t)/2)) yn(ceil(length(t)/2)) yn(ceil(length(t)/2)) yp(ceil(length(t)/2))];

x2 = [ceil(2*length(t)/3) ceil(2*length(t)/3) length(t) length(t)];
y2 = [yp(end) yn(end) yn(end) yp(end)];

figure;
%patch(x0,y0,'green')
%ylim([0 1.5])
%hold on;
%patch(x1,y1,'green')
%patch(x2,y2,'green')
set(0,'defaultlinelinewidth',1.75)
plot(t,x,'r')
ylabel('HbO (mMol.mm)')
xlabel('Time (Samples at 10 Hz)')
%hold off;

% make bars like excel

%% vft curves
x=vft;
afterShock=fs*10;

%x(length(x):(length(x)+afterShock))=x(1);
%x=x/max(max(abs(x)));
t=linspace(0,length(x),length(x));

scaleFac=max([.5,std(x),10.*std(x)]);
yp = 1.*(x + scaleFac);
yn = 1.*(x - scaleFac);
x0 = [0 0 ceil(length(t)/3) ceil(length(t)/3)];
y0 = [yp(1) yn(1) yn(1) yp(1)];

x1 = [ceil(length(t)/3) ceil(length(t)/3) ceil(2*length(t)/3) ceil(2*length(t)/3)];
y1 = [yp(ceil(length(t)/2)) yn(ceil(length(t)/2)) yn(ceil(length(t)/2)) yp(ceil(length(t)/2))];

x2 = [ceil(2*length(t)/3) ceil(2*length(t)/3) length(t) length(t)];
y2 = [yp(end) yn(end) yn(end) yp(end)];

x3 = [length(t) length(t) (length(t)+afterShock) (length(t)+afterShock)];
y3 = [yp(1) yn(1) yn(1) yp(1)];

x(length(x):(length(x)+afterShock))=x(1);
%x=x/max(max(abs(x)));
t=linspace(0,length(x),length(x));

figure;
patch(x0,y0,'green')
%ylim([0 1])
hold on;
patch(x1,y1,'green')
patch(x2,y2,'green')
patch(x3,y3,'green')
set(0,'defaultlinelinewidth',1.75)
plot(t,x,'r')
ylabel('HbO (mMol.mm)')
xlabel('Time (Samples at 10 Hz)')
hold off;

% make bars like excel

%% vft curves with tail
x=vft;
xStart=x(1);
xMid=x(round(length(x)/2));
xEnd=x(round(9*length(x)/10));
afterShock=fs*10;

csTime=linspace(0,1,vftPost);

xx0=xStart*abs(sin(2*pi*(csTime)));
xx1=xMid*abs(sin(2*pi*(csTime)));
xx2=xEnd*abs(sin(2*pi*(csTime)));
x(1:vftPost)=xx0;
x((1+vftPost):(2*vftPost))=xx1;
x((1+(2*vftPost)):(3*vftPost))=xx2;

%x(length(x):(length(x)+afterShock))=x(1);
%x=x/max(max(abs(x)));
t=linspace(0,length(x),length(x));

scaleFac=max([.5,std(x),10.*std(x)]);
yp = 1.*(x + scaleFac);
yn = 1.*(x - scaleFac);
x0 = [0 0 ceil(length(t)/3) ceil(length(t)/3)];
y0 = [yp(1) yn(1) yn(1) yp(1)];

x1 = [ceil(length(t)/3) ceil(length(t)/3) ceil(2*length(t)/3) ceil(2*length(t)/3)];
y1 = [yp(ceil(length(t)/2)) yn(ceil(length(t)/2)) yn(ceil(length(t)/2)) yp(ceil(length(t)/2))];

x2 = [ceil(2*length(t)/3) ceil(2*length(t)/3) length(t) length(t)];
y2 = [yp(end) yn(end) yn(end) yp(end)];

x3 = [length(t) length(t) (length(t)+afterShock) (length(t)+afterShock)];
y3 = [yp(1) yn(1) yn(1) yp(1)];

x(length(x):(length(x)+afterShock))=x(1);
%x=x/max(max(abs(x)));
t=linspace(0,length(x),length(x));

figure;
patch(x0,y0,'green')
%ylim([0 1])
hold on;
patch(x1,y1,'green')
patch(x2,y2,'green')
patch(x3,y3,'green')
set(0,'defaultlinelinewidth',1.75)
plot(t,x,'r')
ylabel('HbO (mMol.mm)')
xlabel('Time (Samples at 10 Hz)')
hold off;

% make bars like excel
%% vft polyfit with tail
x=vft;

afterShock=fs*10;

%x(length(x):(length(x)+afterShock))=x(1);
%x=x/max(max(abs(x)));
t=linspace(0,length(x),length(x));

scaleFac=max([.5,std(x),10.*std(x)]);
yp = 1.*(x + scaleFac);
yn = 1.*(x - scaleFac);
x0 = [0 0 ceil(length(t)/3) ceil(length(t)/3)];
y0 = [yp(1) yn(1) yn(1) yp(1)];

x1 = [ceil(length(t)/3) ceil(length(t)/3) ceil(2*length(t)/3) ceil(2*length(t)/3)];
y1 = [yp(ceil(length(t)/2)) yn(ceil(length(t)/2)) yn(ceil(length(t)/2)) yp(ceil(length(t)/2))];

x2 = [ceil(2*length(t)/3) ceil(2*length(t)/3) length(t) length(t)];
y2 = [yp(end) yn(end) yn(end) yp(end)];

x3 = [length(t) length(t) (length(t)+afterShock) (length(t)+afterShock)];
y3 = [yp(1) yn(1) yn(1) yp(1)];

x(length(x):(length(x)+afterShock))=x(1);
%x=x/max(max(abs(x)));
t=linspace(0,length(x),length(x));
p = polyfit(t,x,8);
x = polyval(p,t);
figure;
patch(x0,y0,'green')
%ylim([0 1])
hold on;
patch(x1,y1,'green')
patch(x2,y2,'green')
patch(x3,y3,'green')
set(0,'defaultlinelinewidth',1.75)
plot(t,x,'r')
ylabel('HbO (mMol.mm)')
xlabel('Time (Samples at 10 Hz)')
hold off;

% make bars like excel
img = imread('glassbrain.png');
imshow(img);




